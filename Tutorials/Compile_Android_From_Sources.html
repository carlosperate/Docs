<!DOCTYPE html>
<!--[if lt IE 7]>       <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>          <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>          <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>Compile Android From Sources</title>
    <meta name="description" content="UDOO Board Documentation" />
    <meta name="author" content="UDOO Team">
    <meta charset="UTF-8">
    <link rel="icon" href="../templates/default/themes/udoo/img/favicon.png" type="image/x-icon">
    <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
     <meta name="google-site-verification" content="GlKlGkbxuWQ3LNWx0akLYkqoWLrtF5b0ug9UpGadSuc" />

<meta name="google-site-verification" content="vL1Qo6JWKZBq6fzVJLJhbyqHya1TBhZd78OJDA-Qe1s" />




<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-40057783-1']);
 _gaq.push(['_setDomainName', 'udoo.org']);
 _gaq.push(['_setAllowLinker', true]);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
   var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 })();

</script>

    <!-- Font -->
    <link href='//fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>
    <!-- CSS -->
    <link href='../templates/default/themes/udoo/css/udoo.css' rel='stylesheet' type='text/css'>
</head>
<body>
            <!-- Docs -->
                    <a href="https://github.com/UDOOboard/Docs" target="_blank" id="github-ribbon" class="hidden-print"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
                <div class="container-fluid fluid-height wrapper">
            <div class="navbar navbar-fixed-top hidden-print">
                <div class="container-fluid">
                    <a class="brand navbar-brand pull-left" href="http://udoo.org"><img src="http://udoo.org/docs/templates/default/themes/udoo/img/logo_docs.png" alt="" />   Docs</a>
                    <p class="navbar-text pull-right">Generated by <a href="http://daux.io">Daux.io</a></p>
                </div>
            </div>
            <div class="row columns content">
                <div class="left-column article-tree col-sm-3 hidden-print">
                    <!-- For Mobile -->
                    <div class="responsive-collapse">
                        <button type="button" class="btn btn-sidebar" id="menu-spinner-button">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                    </div>
                    <div id="sub-nav-collapse" class="sub-nav-collapse">
                        <!-- Navigation -->
                        <ul class="nav nav-list"><li><a href="../Getting_Started.html">Getting Started</a></li><li><a href="../Introduction/index.html" class="folder">Introduction</a><ul class="nav nav-list"><li><a href="../Introduction/Introduction.html">Introduction</a></li></ul></li><li><a href="#" class="aj-nav folder">Getting Started</a><ul class="nav nav-list"><li><a href="../Getting_Started/Very_First_Start.html">Very First Start</a></li><li><a href="../Getting_Started/Create_A_Bootable_MicroSD_card_for_UDOO.html">Create A Bootable MicroSD card for UDOO</a></li><li><a href="../Getting_Started/UDOO_Configuration_Tool.html">UDOO Configuration Tool</a></li></ul></li><li><a href="#" class="aj-nav folder">Advanced Setup</a><ul class="nav nav-list"><li><a href="../Advanced_Setup/Create_A_Bootable_MicroSD_Card_From_Preinstalled_Binaries.html">Create A Bootable MicroSD Card From Preinstalled Binaries</a></li><li><a href="../Advanced_Setup/Create_A_Bootable_MicroSD_Card_From_Sources.html">Create A Bootable MicroSD Card From Sources</a></li><li><a href="../Advanced_Setup/Compile_Android_From_Sources.html">Compile Android From Sources</a></li><li><a href="../Advanced_Setup/UDOO_Boot_From_SATA.html">UDOO Boot From SATA</a></li><li><a href="../Advanced_Setup/UDOO_Kernel_Update_Procedure.html">UDOO Kernel Update Procedure</a></li><li><a href="../Advanced_Setup/UDOO_Usb_Debug.html">UDOO Usb Debug</a></li></ul></li><li><a href="#" class="aj-nav folder">Connecting UDOO</a><ul class="nav nav-list"><li><a href="../Connecting UDOO/Connecting_Via_Serial_Cable.html">Connecting Via Serial Cable</a></li><li><a href="../Connecting UDOO/Find_IP_Address.html">Find IP Address</a></li><li><a href="../Connecting UDOO/Connecting_Via_SSH.html">Connecting Via SSH</a></li></ul></li><li class="open"><a href="#" class="aj-nav folder">Tutorials</a><ul class="nav nav-list"><li><a href="../Tutorials/Install_A_Custom_Debian_Distro_With_Debootstrap.html">Install A Custom Debian Distro With Debootstrap</a></li><li><a href="../Tutorials/Create_A_Virtual_Machine_For_UDOO_Development.html">Create A Virtual Machine For UDOO Development</a></li><li class="active"><a href="../Tutorials/Compile_Android_From_Sources.html">Compile Android From Sources</a></li><li><a href="../Tutorials/UDOO_Switch_Between_Adb_Debug_And_ADK_Connection.html">UDOO Switch Between Adb Debug And ADK Connection</a></li><li><a href="../Tutorials/UDOO_Configure_Ethernet_Under_Android.html">UDOO Configure Ethernet Under Android</a></li><li><a href="../Tutorials/UDOO_Programming_The_Embedded_Arduino_Microcontroller.html">UDOO Programming The Embedded Arduino Microcontroller</a></li><li><a href="../Tutorials/UDOO_Install_The_Arduino_IDE.html">UDOO Install The Arduino IDE</a></li></ul></li><li><a href="#" class="aj-nav folder">Linux</a><ul class="nav nav-list"><li><a href="../Linux/Understanding_Linux_Software_Management_And_Installing.html">Understanding Linux Software Management And Installing</a></li><li><a href="../Linux/Linux_Command_Line_Interface.html">Linux Command Line Interface</a></li><li><a href="../Linux/Create_A_Virtual_Machine_For_UDOO_Development.html">Create A Virtual Machine For UDOO Development</a></li><li><a href="../Linux/Install_Oracle_Java_Development_Kit_On_UDOO_Ubuntu.html">Install Oracle Java Development Kit On UDOO Ubuntu</a></li><li><a href="../Linux/UDOO_Webserver.html">UDOO Webserver</a></li><li><a href="../Linux/Program_Arduino_With_UDOO_IDE.html">Program Arduino With UDOO IDE</a></li><li><a href="../Linux/Linux_GPIO_Manipulation.html">Linux GPIO Manipulation</a></li><li><a href="../Linux/Install_A_Custom_Debian_Distro_With_Debootstrap.html">Install A Custom Debian Distro With Debootstrap</a></li></ul></li><li><a href="#" class="aj-nav folder">More Examples</a><ul class="nav nav-list"><li><a href="../More_Examples/Hello_World.html">Hello World</a></li></ul></li><li><a href="#" class="aj-nav folder">Android</a><ul class="nav nav-list"><li><a href="../Android/UDOO_Android_Boot_Walkthrough.html">UDOO Android Boot Walkthrough</a></li><li><a href="../Android/Android_And_Arduino_Simple_Hello_World_Tutorial.html">Android And Arduino Simple Hello World Tutorial</a></li><li><a href="../Android/Android_And_Arduino_On_UDOO_Bidirectional_Communication.html">Android And Arduino On UDOO Bidirectional Communication</a></li><li><a href="../Android/UDOO_Configure_Ethernet_Under_Android.html">UDOO Configure Ethernet Under Android</a></li><li><a href="../Android/How_To_Install_Gapps_On_UDOO_Running_Android.html">How To Install Gapps On UDOO Running Android</a></li><li><a href="../Android/UDOO_Switch_Between_Adb_Debug_And_ADK_Connection.html">UDOO Switch Between Adb Debug And ADK Connection</a></li></ul></li><li><a href="#" class="aj-nav folder">Arduino</a><ul class="nav nav-list"><li><a href="../Arduino/UDOO_Install_The_Arduino_IDE.html">UDOO Install The Arduino IDE</a></li><li><a href="../Arduino/Program_UDOO_Arduino_Processor_From_External_PC.html">Program UDOO Arduino Processor From External PC</a></li><li><a href="../Arduino/UDOO_Programming_The_Embedded_Arduino_Microcontroller.html">UDOO Programming The Embedded Arduino Microcontroller</a></li><li><a href="../Arduino/Arduino_Shields_With_UDOO.html">Arduino Shields With UDOO</a></li></ul></li><li><a href="#" class="aj-nav folder">Resources</a><ul class="nav nav-list"><li><a href="../Resources/UDOO_GPIO_Pinout.html">UDOO GPIO Pinout</a></li><li><a href="../Resources/IMX6_And_Sam3X_Communication.html">IMX6 And Sam3X Communication</a></li><li><a href="../Resources/UDOO_Setup_lvds_panels.html">UDOO Setup lvds panels</a></li><li><a href="../Resources/UDOO_Camera_Module.html">UDOO Camera Module</a></li><li><a href="../Resources/Official_Distributions.html">Official Distributions</a></li></ul></li><li><a href="#" class="aj-nav folder">Communication Between The 2 Processors</a><ul class="nav nav-list"><li><a href="../Communication_Between_The_2_Processors/UDOO_Seral_Libraries_Examples.html">UDOO Seral Libraries Examples</a></li><li><a href="../Communication_Between_The_2_Processors/Interaction_Between_Linux_And_Arduino_On_UDOO.html">Interaction Between Linux And Arduino On UDOO</a></li></ul></li><li><a href="#" class="aj-nav folder">Hardware & Accessories</a><ul class="nav nav-list"><li><a href="../Hardware & Accessories/UDOO_GPIO_Pinout.html">UDOO GPIO Pinout</a></li><li><a href="../Hardware & Accessories/IMX6_And_Sam3X_Communication.html">IMX6 And Sam3X Communication</a></li><li><a href="../Hardware & Accessories/UDOO_Setup_lvds_panels.html">UDOO Setup lvds panels</a></li><li><a href="../Hardware & Accessories/UDOO_Camera_Module.html">UDOO Camera Module</a></li><li><a href="../Hardware & Accessories/Connect_UDOO_Camera_Module.html">Connect UDOO Camera Module</a></li></ul></li><li><a href="#" class="aj-nav folder">Software & OS Distro</a><ul class="nav nav-list"><li><a href="../Software_&_OS_Distro/Official_Distributions.html">Official Distributions</a></li></ul></li><li><a href="#" class="aj-nav folder">Projects Examples</a><ul class="nav nav-list"><li><a href="../Projects_Examples/Face_Recognition_And_Face_Tracking_Via_OpenCV_And_UDOO.html">Face Recognition And Face Tracking Via OpenCV And UDOO</a></li><li><a href="../Projects_Examples/Remote_Metereological_Station_With_UDOO.html">Remote Metereological Station With UDOO</a></li><li><a href="../Projects_Examples/DIY_NAS_With_Openmediavault_And_UDOO.html">DIY NAS With Openmediavault And UDOO</a></li></ul></li><li><a href="../Serial_Libraries/index.html" class="folder">Serial Libraries</a><ul class="nav nav-list"><li><a href="../Serial_Libraries/Java_Serial_Libraries.html">Java Serial Libraries</a></li><li><a href="../Serial_Libraries/C_Serial_Libraries.html">C Serial Libraries</a></li><li><a href="../Serial_Libraries/PHP_Serial_Libraries.html">PHP Serial Libraries</a></li><li><a href="../Serial_Libraries/Python_Serial_Libraries.html">Python Serial Libraries</a></li></ul></li><li><a href="#" class="aj-nav folder">Mods</a><ul class="nav nav-list"><li><a href="../Mods/Mod_Your_UDOO_To_Improve_WiFi_Performances.html">Mod Your UDOO To Improve WiFi Performances</a></li></ul></li><li><a href="#" class="aj-nav folder">FAQ</a><ul class="nav nav-list"><li><a href="../FAQ/Introductive.html">Introductive</a></li></ul></li><li><a href="#" class="aj-nav folder">Troubleshooting</a><ul class="nav nav-list"><li><a href="../Troubleshooting/Why_My_UDOO_Wont_Boot.html">Why My UDOO Wont Boot</a></li><li><a href="../Troubleshooting/How_Can_I_Solve_My_HDMI_Issues.html">How Can I Solve My HDMI Issues</a></li><li><a href="../Troubleshooting/How_Do_I_Set_Up_My_LVDS_Panel.html">How Do I Set Up My LVDS Panel</a></li></ul></li><li><a href="#" class="aj-nav folder">Hackaton Survival Guide</a><ul class="nav nav-list"><li><a href="../Hackaton_Survival_Guide/Mirroring_UDOOs_Desktop_on_your_PC_with_VNC_Remote_Desktop.html">Mirroring UDOOs Desktop on your PC with VNC Remote Desktop</a></li><li><a href="../Hackaton_Survival_Guide/Programming_UDOOs_Arduino_from_your_PC.html">Programming UDOOs Arduino from your PC</a></li><li><a href="../Hackaton_Survival_Guide/Useful_Resources.html">Useful Resources</a></li></ul></li></ul>                                                    <div class="well well-sidebar">

                                <!-- Links -->
                                <a href="http://udoo.org" target="_blank">Home</a><br><a href="http://udoo.org/downloads" target="_blank">Downloads</a><br><a href="http://udoo.org/tutorial" target="_blank">Tutorials</a><br><a href="http://udoo.org/forum" target="_blank">Forum</a><br>                                <a href="#" id="toggleCodeBlockBtn" onclick="toggleCodeBlocks();">Show Code Blocks Inline</a><br>
                                <!-- Twitter -->
                                                                    <div class="twitter">
                                        <hr/>
                                        <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=UDOO_Board&amp;show_count=false"></iframe>
                                    </div>
                                                            </div>
                                            </div>
                </div>
                <div class="right-column float-view content-area col-sm-9">
                    <div class="content-page">
                        <article>
                                                            <div class="page-header">
                                    <h1>Compile Android From Sources                                                                            </h1>
                                </div>
                            
                            <p>This wiki describes the necessary steps to start and use the pre-compiled Android software support package for UDOO Board. Moreover, a description of how to rebuild the bootloader, kernel and Android file system is provided. The procedure described in this wiki refers to UDOO Board Dual and Quad version.</p>
<h2>System Requirements</h2>
<p>Android system for UDOO board is provided as precompiled images or as source code to be customized and rebuilt. Running the full procedure described in this wiki, rebuilding the Android system from source files, it is necessary to have an host PC (or Virtual Machine) running Ubuntu Linux 10.04 64bit with at least 40 GB of free disk space, configured in the set up the work environment section below. The host PC should also include:</p>
<ul>
<li>an SD/µSD card reader;</li>
<li>a microUSB cable to connect UDOO to host and access debug serial;</li>
<li>an host pc with internet connection;</li>
</ul>
<h3>Terminology</h3>
<p>The set of scripts and images necessary to run Android on a board is generically called a Distro.</p>
<h2>Set up the work environment</h2>
<p>Given an host PC (or Virtual Machine) running Ubuntu Linux 10.04 64bit with at least 40 GB of free disk space, it is required to install all the necessary packages for a standard Android build, as reported on the Android website at <a href="http://source.android.com/source/initializing.html">http://source.android.com/source/initializing.html</a>.</p>
<p>We suggest to use a Virtual Machine environment to create a close and dedicated workspace. It reduce risks of procedure and libraries mismatching or to corrupt other working enviroments present on the host machine.</p>
<p>This wiki shows how to <a href="/docs/Tutorials/Create_A_Virtual_Machine_For_UDOO_Development">create a Virtual Machine for Android Development</a></p>
<h2>Serial communication</h2>
<p>While not exactly necessary, serial communication with UDOO is strongly recommended as the first debug method. In order to use the serial debug port on UDOO, after connecting the board and host PC ports, it is necessary to install and setup an application for serial communication, such as minicom, cutecom or gtkterm (to mention only the most famous). There is no specific requirement on the application to use, here we only consider minicom, but settings for the others are equivalent.</p>
<p>Install minicom</p>
<pre><code class="language-bash">
HOST$ sudo apt-get install minicom
</code></pre>
<p>Launch minicom in setup mode (and with Linewrap ON, not necessary but useful)</p>
<pre><code class="language-bash">
HOST$ sudo minicom -sw
</code></pre>
<p>Select “Serial port setup” and check the following parameters</p>
<ul>
<li>Serial Device, option A (usually, /dev/ttyS0 or /dev/ttyUSB0 in case an USB adapter is used)</li>
<li>Communications parameters, option E (must be 115200 8N1)</li>
<li>No flow control, neither hardware nor software, options F and G</li>
</ul>
<p>Save the settings as default.</p>
<p>Exit closes setup and opens minicom, instead “Exit from minicom” completely closes minicom, and you have to run it again without setup options</p>
<pre><code class="language-bash">
HOST$ sudo minicom -w
</code></pre>
<h2>Run Android</h2>
<p>Right now the Android OS can boot only from a Micro SD. Here we consider only to boot UDOO from the external SD present on board. In order to install and run a Distro on UDOO, it is sufficient to prepare an SD with the Android system images, connect it to the board and power up the board.</p>
<h3>Notes on the prebuilt images</h3>
<p>In order to simplify packages distribution and use, the bootloader prebuilt images are compiled for only a set of the possible configurations, allowing anyway to boot any platform. In particular, we provide:</p>
<ul>
<li>prebuilt images for UDOO Dual and 1 GB of DDR</li>
<li>prebuilt images for UDOO QUad and 1 GB of DDR</li>
</ul>
<h3>Boot Android from SD</h3>
<p>When the script ends, insert the SD into the SD card slot and power up the device. The Android system boots. You can see the Android bootscreen on a connected HDMI monitor within 20 seconds, while messages on the serial debug port start to be sent almost immediately. First of all, messages from the bootloader can be seen. Among the rest, characteristics of the board are shown: CPU type, boot device and memory size. Please check the correctness of this information. The kernel is automatically launched after a 3 second countdown. The first time Android System boots, it must configure the storage amd prepare folders for data and applications. As a consequence, every time the SD is prepared with the procedure described in this section, the first boot takes around 1 minute, while subsequent boots are much faster. At the end of the boot procedure, you can interact with the system either with mouse and keyboard and the HDMI display, or with a root console automatically opened in serial.</p>
<p>The serial debug port is used for two different reasons: The bootloader and kernel send debug messages via serial port, so that the user can monitor the low level system state; a root console is opened on the seriaI port, allowing bootloader configuration and system control.</p>
<p>The number of messages sent via serial port can be very high. For this reason, it is quite useful to increase scrolling capabilities of the terminal, possibly setting them to a very high or even unlimited.</p>
<h2>Build Android</h2>
<p>For a better tune-up of the system, it is possible to build the Android system images from scratch, rather than use the precompiled images.</p>
<p>Create a folder and get the source code, download tar file containing sources from <a href="http://www.udoo.org/downloads/">http://www.udoo.org/downloads/</a></p>
<pre><code class="language-bash">
HOST# cd [udoo-android-dev]
HOST# tar –xzvpf UDOO_Android-4.3_Source_v2.0.tar.gz
</code></pre>
<p>It take up to an hour to download files from git. [udoo-android-dev] contain Androids sources and a series of scripts that helps in configuring the environment, building the system and preparing a new set of images to be run on UDOO Board (following again the procedure described in Run Android section).</p>
<p>In order to build the whole system, it is necessary to</p>
<ul>
<li>configure the environment</li>
<li>build the bootloader (u-boot)</li>
<li>build kernel and Android system</li>
</ul>
<p>Each step is considered separately.</p>
<h3>Configure the environment</h3>
<p>Prior to build the system, it is necessary to configure the Android environment for the specific build. In particular, the following commands have to be launched:</p>
<pre><code class="language-bash">
HOST$ export ARCH=arm
HOST$ export CROSS_COMPILE=$PWD/prebuilts/gcc/linux-x86/arm/arm-eabi-4.6/bin/arm-eabi-
HOST$ export PATH=$PWD/bootable/bootloader/u-boot-imx/tools:$PATH
HOST$ source build/envsetup.sh
</code></pre>
<p>Finally, it is neces sary to choose which target to build. The command below shows a list of possible targets</p>
<pre><code class="language-bash">
HOST$ lunch
</code></pre>
<p>For each possible target, the first part of the name indicates the board you are building for, while the second part selects the build type, as described at <a href="http://source.android.com/source/building-running.html">http://source.android.com/source/building-running.html</a>.</p>
<p>In particular, valid options to build for UDOO board are:</p>
<ul>
<li>udoo-user: build for production, with limited access</li>
<li>udoo-eng: build for development, with root access and additional debugging tools</li>
</ul>
<p>The target selection can alternatively be done directly at command line, calling for example</p>
<pre><code class="language-bash">
HOST$ lunch udoo-eng
</code></pre>
<p>Once all these steps are done, several environment variables are set. Among the rest, it is worth noting the environment variable OUT, automatically set to [udoo-android-dev]/out/target/product/udoo, that is the folder where Android system is actually built, and where object files, folders and system images are created. From now on, this folder is called [OUT].</p>
<p>For everyday development, a command list is provided that automatically launches all the commands above:</p>
<pre><code class="language-bash">
HOST$ . setup udoo-eng
</code></pre>
<p>or alternatively</p>
<pre><code class="language-bash">
HOST$ . setup udoo-user
</code></pre>
<h3>Build u-boot</h3>
<p>Move to the folder where bootloader sources are located, with command</p>
<pre><code class="language-bash">
HOST$ cd [udoo-android-dev]/bootable/bootloader/uboot-imx
</code></pre>
<p>The sources can be compiled for different boards, modules and OS. A script is provided to guide u boot compilation, and help in configuring the bootloader for the specific Module and system characteristics. It is sufficient to launch the following command to run the script for configuration.</p>
<p>Note that you need to have dialog package installed before being able to see textual menus.</p>
<pre><code class="language-bash">
HOST$ ./compile.sh -c
</code></pre>
<p>In a graphical menu, it is possible to choose some compilation options: The following settings are allowed:</p>
<ul>
<li><strong>DDR Size:</strong> 1 options are given GB with bus size 64 (4 banks, each of 256 MB)</li>
<li><strong>Board Type:</strong> Udoo must be chosen.</li>
<li><strong>CPU Type:</strong> refers to i.MX6 specific CPU, values are Quad and Dual.</li>
<li><strong>OS Type:</strong> Linux or Android, Android must be selected.</li>
<li><strong>Environment device:</strong> where the u-boot environment is stored. SD/MMC must be selected.</li>
<li><strong>Extra option:</strong> at the moment, in this submenu it is only possible to force clean before compile.</li>
<li><strong>Compiler options:</strong> here the compiler path can be chosen (this is useful for Linux only, leave this as it is), and part of the u-boot version string can be customized.</li>
</ul>
<p>Once all settings are checked, select Exit, and the following screen select OK to just save the settings or Yes, with Compile to save and directly compile the bootloader.</p>
<p>If you saved the settings, you can also rebuild u-boot with the command:</p>
<pre><code class="language-bash">
HOST$ ./compile.sh
</code></pre>
<p>This operation usually takes less than a minute (but depends on the host PC). In the end, the bootloader image u-boot.bin is placed in the same directory and is ready to be used to boot the UDOO Board.</p>
<h3>Build Android system image</h3>
<p>The easiest but most time-consuming step in building Android is to build the Android system image. In general, after configuring the environment as in configuration section, it is sufficient to launch the following command (from the main folder [udoo-android-dev]) to build the whole system image, including the kernel:</p>
<p>The code:</p>
<pre><code class="language-bash">
HOST$ make
</code></pre>
<p>The duration of the whole system build is strongly dependent on the host PC you are working on, but this can take up to several hours, and builds more than 20GB of compiled code (this is the size of the [udoo-android-dev]/out/ folder when the operation is completed). Enabling parallel compilation can speed up the process.</p>
<p>In general, the idea is to let the compiler to launch several compiling jobs in parallel, where the number of jobs depends on the specific PC you are working on.</p>
<pre><code class="language-bash">
HOST$ make -jN
</code></pre>
<p>where N is the maximum number of parallel jobs allowed. For a better explanation of this point (included the value to assign to N), please see <a href="http://source.android.com/source/building-running.html">http://source.android.com/source/building-running.html</a>, in Build the Code section above.</p>
<p>Several files and folders are created in [OUT]. Among the rest we underline:</p>
<ul>
<li>root/ and ramdisk.img: root file system and generated image</li>
<li>recovery/ and ramdisk-recovery.img: root file system used in recovery mode, and generated image</li>
<li>system/ and system.img: Android system including binaries and libraries, and generated image</li>
<li>data/ and userdata.img: Android data area and generated image</li>
<li>kernel and uImage: kernel images</li>
<li>boot.img: kernel and initial root ramdisk, generated from kernel and ramdisk.img</li>
<li>recovery.img: kernel and initial root ramdisk used in recovery mode, generated from kernel and ramdisk-recovery.img</li>
</ul>
<p>Together with the bootloader image created in the build U-Boot section above, the images are sufficient to boot UDOO board with the default kernel configuration, as described below in the "Use the new Android system images" section. Instead if it is necessary to customize the kernel, the procedure is described in the kernel section below.</p>
<h3>Build Kernel</h3>
<p>The kernel is built together with the rest of the Android system. However, it is also possible to modify the configuration and rebuild it separately. As for the bootloader, the kernel can be configured and customized for a very wide range of boards and peripherals. Linux kernel customization is a very complex task, an in-depth description is out of the scope of this document. Here we consider only the default configuration to run linux kernel on UDOO board.</p>
<p>It is possible to configure (or restore) the kernel to the default configuration for the Module calling the command below:</p>
<p>The command:</p>
<pre><code class="language-bash">
HOST$ make -C kernel_imx imx6_udoo_android_defconfig
</code></pre>
<p>If you wish to check the configuration or customize it, use</p>
<pre><code class="language-bash">
HOST$ make -C kernel_imx menuconfig
</code></pre>
<p>The command opens a graphical configuration tool equivalent to the one for u-boot. Any saved change is stored in the same folder as an hidden file called .config, which then is the actual configuration file used to compile the kernel.</p>
<p>Once the configuration is ready, the kernel is compiled with command</p>
<pre><code class="language-bash">
HOST$ make bootimage
</code></pre>
<p>This operation can take up to 30 minutes to complete, and performs several actions:</p>
<ul>
<li>builds the kernel, creating the images uImage and zImage in [udoo-android-dev]/kernel_imx/arch/arm/boot</li>
<li>copies the kernel images in [OUT] (zImage is renamed to kernel)</li>
<li>updates root/ and ramdisk.img</li>
<li>updates boot.img from ramdisk.img and kernel</li>
</ul>
<p>When it is done, the new boot.img is present in [OUT], ready to be used to boot the Module.</p>
<h3>Use the new Android system images</h3>
<p>Once the new Android system images are created, it is necessary to prepare a µSD card with the images and boot UDOO board. A script is provided to help with this step. In a way similar to what is described in the Run Android section, the script will partition and format the SD card and then copies the new Android images into the correct partitions, reading them directly from [$OUT] (and [udoo-android-dev]/bootable/bootloader/uboot-imx for the bootloader). It is sufficient to follow the next steps.</p>
<p>Connect the SD card to your host PC, and use the dmesg command to find the device name; we suppose it is /dev/sdc.</p>
<p>Launch the script to prepare the SD</p>
<pre><code class="language-bash">
HOST# croot
HOST# sudo -E ./make_sd.sh /dev/sdc
</code></pre>
<p>When this is done, the SD card containing the images is ready to boot UDOO as described in the Boot Android from SD section.</p>
<h2>Prepare a Distro</h2>
<p>It is sometimes useful to prepare a new Distro to be stored.</p>
<p>To do this, once the new images are built following the procedures described in the previous Sections, it is sufficient to call the command</p>
<pre><code class="language-bash">
HOST$ ./prepare_distro.sh [distro_name]
</code></pre>
<p>Called without arguments, the script creates a new folder UDOO_Android_4.3_Distro, containing the freshly built Android system images, and the scripts to use them. An archive UDOO_Android_4.3_Distro.tar.gz is also prepared for distribution. The optional parameter [distro_name] can be used to customize the folder and archive name. Once the archive is ready, its use is described in Run Android section.</p>                                                    </article>
                    </div>
                </div>
            </div>
        </div>
    
                <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-40057783-1', '');ga('send', 'pageview');</script>    

    <!-- jQuery -->
            <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined')
                document.write(unescape("%3Cscript src='../js/jquery-1.11.0.min.js' type='text/javascript'%3E%3C/script%3E"));
        </script>
    
    <!-- hightlight.js -->
    <script src="../js/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- JS -->
    
    <!-- Front end file editor -->
        <script src="../js/custom.js"></script>
    <!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

</body>
</html>

